<html>

<head>
	<style>
		.pad10{
			padding: 10px 100px 10px 100px
		}
		.pad20{
			padding: 10px 100px 20px 100px
		}
	</style>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
	<title>Check User Account</title>
	<script src="js/HTTPRequest.js"></script>
	<script src="js/site.js"></script>
	<link href="css/Style.css" rel="stylesheet" type="text/css" media="screen" />
</head>
   
<body>
	<header class="site-header">
		<div class="clear"></div>
			<div class="inner-wrap">
				<div class="navbar-brand-wpz">
					<a href="http://demo.wpzoom.com/foodica" title="Food Recipes Theme for WordPress">
						<font size="10">Check User Account</font>
					</a>
				</div><!-- .navbar-brand -->
			</div>
		
		<!-- <div id="mysticky-wrap" style="margin-bottom: 40px;"> -->
			<!-- <div id="mysticky-nav" style="top: -60px;" class=""> -->
				<!-- <nav class="main-navbar" role="navigation" style=""> -->
					<!-- <div class="inner-wrap"> -->
						<!-- <div id="navbar-main"> -->
							<!-- <div class="menu-main-container"> -->
								<!-- <ul id="menu-main-1" class="navbar-wpz dropdown sf-menu sf-js-enabled sf-arrows"> -->
									<!-- <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-106"><a href="Create.html">Create</a></li> -->
									<!-- <li class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-has-children menu-item-207"> -->
										<!-- <a href="Read.html">Read</a></li> -->
									<!-- <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-163"><a href="Update.html">Update</a></li> -->
									<!-- <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-163"><a href="Delete.html">Delete</a></li> -->
								<!-- </ul> -->
							<!-- </div> -->
						<!-- </div><!-- #navbar-main -->
					<!-- </div><!-- ./inner-wrap --> 
				<!-- </nav> -->
			<!-- </div> -->
		<!-- </div> -->
		<div class="clear"></div>
	</header>	
	
	<center><br>User email : 
	<input type="text" name="identifier" id="personEmail">  &nbsp;
	<img src="Script\assets\images\pngs\search.png" onclick="showForm()" width="30" height="30"/>
	</center>
	
	<table id="TabPerson" align="center" border="1"></table><br>
	<div style="display:none;" id="loader"></div>
	<div style="display:none;" id="myModal" class="modal">
	
	<script>
	alert('1. Input user email. \n2. Then click "Delete" button of related data');
	function showForm(){
		getResource(FHIRURL, 'Person', '?identifier=' + document.getElementById("personEmail").value, FHIRResponseType, 'getPatientByEmail');
	}
	
	function getPatientByEmail(obj){
		let template = [];
		if (obj.total == 0)	alert('User not exist!');
		else{
			template.push(`<tr>
				<th>No.</th>
				<th>Person Id</th>
				<th>Name</th>
				<th>Username</th>
				<th>Patient ID</th>
				<th>Tool</th>
			</tr>`);
			obj.entry.map((entry, i) => {
				retID = (entry.resource.id) ? entry.resource.id : '';
				retName = (entry.resource.name) ? entry.resource.name[0].text : '';
				retUsername= (entry.resource.identifier)? entry.resource.identifier[0].value : '';
				patientID = (entry.resource.link) ? entry.resource.link[0].target.reference:'';
				template.push(`
				<tr>
					<td>${i + 1}</td>
					<td>${retID}</td>
					<td>${retName}</td>
					<td>${retUsername}</td>
					<td>${patientID}</td>
					<td><input type="button" value="delete" onclick="deleteData(retID)"/></td>
				</tr>`);
			});
			document.getElementById('TabPerson').innerHTML= template.join('');;
		}
	}
	
	function deleteData(id){
		HTTPDeleteData(FHIRURL + "/Person/" + id);
	}
	
	</script>
</body>
</html>